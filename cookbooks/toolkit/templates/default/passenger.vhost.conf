<VirtualHost *:80>
    ServerAdmin info@cyclestreets.net

    ServerName www.cyclescape.org
    ServerAlias cyclescape.org *.cyclescape.org
    ServerAlias cyclescape.net *.cyclescape.net
    ServerAlias cyclescape.com *.cyclescape.com
    ServerAlias cyclescape.org.uk *.cyclescape.org.uk

    RewriteEngine on
    RewriteCond %{HTTP_HOST} !cyclescape.org$ [NC]
    RewriteRule ^/(.*) http://www.cyclescape.org/$1 [L,R]

    RewriteCond %{HTTP_HOST} ^cyclescape.org$ [NC]
    RewriteRule ^/(.*) http://www.cyclescape.org/$1 [L,R]

    AddExternalAuth pwauth /usr/sbin/pwauth
    SetExternalAuthMethod pwauth pipe

    DocumentRoot /var/www/toolkit/current/public
    <Directory /var/www/toolkit/current/public>
        AllowOverride all
        Options -MultiViews

        AuthType Basic
        AuthName "Beta Testing"
        AuthBasicProvider external
        AuthExternal pwauth
        require valid-user
    </Directory>

    RailsEnv production
</VirtualHost>
